---
title: Landing Commands
category: Post-Exploitation
order: 2
---

> **Linux**

Kernal version  | <code> uname -r </code>
Determine Account | <code> whoami </code>
Add User | <code> useradd -d [home_dir] [login name] </code>
Privilidges |<code>  id </code>
Network Activity | <code> netstat -natu </code>
ARP Cache | <code> arp -a </code>
Routing Table | <code> netstat -nr </code>
Lockout Policy | <code> grep tally /etc/pam.d/* <br> grep tally /etc/pam.conf" </code>
Find Public IP Address | <code> curl icanhazip.com <br> nslookup myip.opendns.com resolver1.opendns.com </code>
Passwords and Users | <code> cat etc/passwd && cat etc/shadow </code>
Wifi Password | <code> /etc/NetworkManager/system-connections </code>
Gnome Keyring | <code> ~/.gnome/keyrings </code>
Find Interesting File Names and Perms | <code> find / -iname "shadow*" -perm /o+r -ls 2>/dev/null </code>
Find Interesting Content Files 1 | <code> grep -irIL pass /opt/ 2>/dev/null </code>
Find Interesting Content Files 2 | <code> find /home -iname "*.txt" 2>/dev/null -exec grep -c 2 -li  'pass' {} \; </code>
Find Interesting Content Regex | <code> find /home -iname "*.txt" 2>/dev/null -exec egrep -li "^.+@.+$" {} \; </code>

> **Windows**

Determine Account | <code> whoami, set username </code>
DNS Cache | <code> ipconfig /displaydns </code>
Arp Cache | <code> arp -a </code>
Network Activity | <code> netstat -na | find "ESTABLISHED" </code>
Processes | <code> tasklist </code>
Services | <code> sc query </code>
Inventory Software | <code> dir /s  c:\Program Files > inventory.txt <br> dir /s ""c:\Program Files (x86)"" >> inventory.txt <br> set path </code>
Routing Table | <code> netstat -nr  </code>
List Users | <code> net user <br> wmic useraccount list brief </code>
List Groups | <code> net localgroup [/domain] </code> 
List Administrators | <code> net localgroup administrators [/domain] </code> 
List Password and Lockout Policy | <code> net accounts or net accounts /domain </code> 
Ping Sweep | <code> for /L %i in (1, 1, 255) do @ping -n 1 192.168.2.%i | find "TTL" </code> 
DNS Lookup | <code> for /L %i in (1, 1, 255) do @echo 10.10.10.%i & nslookup 10.10.10.%i  2>nul | find "Name" </code> 
Password Guess | <code> for /f %i in (password.lst) do @echo %i & @net use \\[tartet_IP_addr] %i /u:[UserName] 2>nul && echo [UserName]: %i >> success.txt </code> 
Find Public IP Address | <code> curl icanhazip.com <br> nslookup myip.opendns.com resolver1.opendns.com </code>
List Domain Controllers | <code> NETDOM QUERY /D:MyDomain DC </code>
List Domain Controllers | <code> DSQUERY Server </code>
List Member Servers | <code> NETDOM QUERY /D:MyDomain SERVER </code>
List all Workstations | <code> NETDOM QUERY /D:MyDomain WORKSTATION </code>
List Groups for Account | <code> DSQUERY USER -samid loginname | DSGET USER -memberof -expand </code>
List all shares for a system | <code> net view [system] /ALL [/Domain] </code>
Find Interesting Files | <code> ls -r -file -filter pass* </code>
Find Interesting Info in Files | <code> ls -r c:\ -file | % {select-string -path $_ -pattern mypassword} </code>
PowerShell port scanner | <code> 1..1024 | % {echo ((new-object Net.Sockets.TcpClient).Connect("10.0.0.100",$_)) "Port $_ is open!"} 2>$null </code>
Scan a range of IPs for a single port | <code> foreach ($ip in 1..20) {Test-NetConnection -Port 80 -InformationLevel "Detailed" 192.168.1.$ip} </code>
PS IP range & port range scanner | <code> 1..20 | % { $a = $_; 1..1024 | % {echo ((new-object Net.Sockets.TcpClient).Connect("10.0.0.$a",$_)) "Port $_ is open!"} 2>$null} </code>
PS test egress filtering | <code> 1..1024 | % {echo ((new-object Net.Sockets.TcpClient).Connect("allports.exposed",$_)) "Port $_ is open!" } 2>$null </code>

> **Firefox**

Finding user browser history and passwords in history:
{% highlight bash %}
sqlite3 ~/pilfered-firefox-profile/gn2uzbr6.Default\ User/places.sqlite sqlite> select * from moz_places where url like "%@%";

Cd ~/.mozilla/firefox/g4iiysbk.default/Cache
Strings [filename] | grep [file eg php]
{% endhighlight %}


> **Interesting Files**

Passwords.txt	| Users often create password files as reminders.
wp-config.php | 	WordPress configuration file. Stores database passwords.
key3.db / logins.json	| Password file for the Firefox web browser.
<custom>.sh	| Administrators often store plaintext passwords in automation scripts
fstab	| The fstab may contain passwords to mounted samba shares
*.pst	| Users may email passwords around. These can often be found in .pst files
  
> **Regex Library**

[regexlib](http://www.regexlib.com/)

